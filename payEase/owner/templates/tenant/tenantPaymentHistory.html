{% extends "base/owner_layout.html" %}

{% block title %}Payment History{% endblock %}

{% block navbar %}
<a href="{% url 'ownerDashboard' %}" class="hover:text-accent">Dashboard</a>
<a href="{% url 'addBuilding' %}" class="hover:text-accent">Add Building</a>

<a href="{% url 'logoutOwner' %}">
    <button class="px-3 py-1 rounded-lg font-semibold btn-red">
        Logout
    </button>
</a>
{% endblock %}


{% block back %}
<a href="{% url 'flatDetails' flat.building.id flat.id %}" class="text-accent transition">Back</a>
{% endblock %}



{% block content %}

<h1 class="text-3xl font-bold text-primary mb-6">
    Payment History — Flat {{ flat.flat_number }}
</h1>

{% if tenant %}
    <p class="text-primary mb-4 text-lg">
        <span class="text-muted font-semibold">Tenant:</span> {{ tenant.name }} ({{ tenant.phone }})
    </p>
{% else %}
    <p class="text-muted mb-4">No tenant currently assigned.</p>
{% endif %}


<!-- SCROLLABLE TABLE (identical to All Transactions) -->
<div class="overflow-x-auto bg-card border-dark rounded-xl shadow">

    <table class="w-full min-w-[700px] text-left text-primary">

        <thead class="bg-[#1f2937]">
            <tr>
                <th class="py-3 px-4 text-sm font-semibold">Month</th>
                <th class="py-3 px-4 text-sm font-semibold">Amount</th>
                <th class="py-3 px-4 text-sm font-semibold">Payment ID</th>
                <th class="py-3 px-4 text-sm font-semibold">Date</th>
                <th class="py-3 px-4 text-sm font-semibold">Status</th>
            </tr>
        </thead>

        <tbody>
        {% if payments %}
            {% for p in payments %}
            <tr class="border-b border-dark hover:bg-bg-card-hover transition">

                <td class="py-3 px-4 text-muted">{{ p.month }}</td>
                <td class="py-3 px-4 text-primary">₹{{ p.amount }}</td>
                <td class="py-3 px-4 text-sm text-primary">{{ p.payment_id }}</td>
                <td class="py-3 px-4 text-sm text-muted">{{ p.date_paid|date:"F j, Y" }}</td>

                <td class="py-3 px-4">
                    {% if p.status == "PAID" %}
                        <span class="px-2 py-1 rounded text-xs font-semibold"
                              style="background:rgba(34,197,94,0.2); color:#22c55e;">
                            PAID
                        </span>
                    {% else %}
                        <span class="px-2 py-1 rounded text-xs font-semibold"
                              style="background:rgba(239,68,68,0.2); color:#ef4444;">
                            FAILED
                        </span>
                    {% endif %}
                </td>

            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="5" class="text-center py-6 text-muted">
                    No payment records found.
                </td>
            </tr>
        {% endif %}
        </tbody>

    </table>

</div>


{% endblock %}
